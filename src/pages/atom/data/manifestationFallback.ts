import type { AtomManifestationResponse } from '../../../api'

type ManifestationKey = `${string}|${string}|${string}`

type ManifestationRow = {
  name: string
  value: string
  units?: string
}

const key = (vendor: string, machine: string, model: string): ManifestationKey =>
  `${vendor.toLowerCase()}|${machine.toLowerCase()}|${model.toLowerCase()}`

const FALLBACK_DATA: Record<ManifestationKey, ManifestationRow[]> = {
  [key('Caterpillar', 'Excavator', '395')]: [
    { name: 'Engine Model', value: 'Cat C18' },
    { name: 'Net Power (ISO 9249)', value: '542', units: 'hp' },
    { name: 'Bore', value: '6', units: 'in' },
    { name: 'Stroke', value: '7', units: 'in' },
    { name: 'Displacement', value: '1105', units: 'in^3' },
    { name: 'Max Pressure (Equipment)', value: '5366', units: 'psi' },
    { name: 'Max Pressure (Travel)', value: '5076', units: 'psi' },
    { name: 'Max Pressure (Swing)', value: '4496', units: 'psi' },
    { name: 'Main Hydraulic Flow (Implement)', value: '281', units: 'gal/min' },
    { name: 'Max Swing Torque', value: '267333', units: 'lbf-ft' },
    { name: 'Operating Weight', value: '207400', units: 'lb' },
    { name: 'Fuel Tank Capacity', value: '322', units: 'gal' },
    { name: 'Cooling System Capacity', value: '19', units: 'gal' },
    { name: 'Engine Oil Capacity', value: '18', units: 'gal' },
    { name: 'Swing Drive Capacity (each)', value: '6', units: 'gal' },
    { name: 'Final Drive Capacity (each)', value: '5', units: 'gal' },
    { name: 'Hydraulic System Capacity (incl. tank)', value: '196', units: 'gal' },
    { name: 'Hydraulic Tank Capacity', value: '98', units: 'gal' },
    { name: 'DEF Tank Capacity', value: '21.1', units: 'gal' },
    { name: 'Boom Length (GP)', value: '8.4', units: 'm' },
    { name: 'Stick Length (R)', value: '4.4', units: 'm' },
    { name: 'Max Reach at Ground Level', value: '48.3', units: 'ft' },
    { name: 'Maximum Cutting Height', value: '44.5', units: 'ft' },
    { name: 'Shipping/Transport Length', value: '49.6', units: 'ft' },
    { name: 'Tail Swing Radius', value: '15.11', units: 'ft' },
    { name: 'Track Gauge', value: '11.6', units: 'ft' },
    { name: 'Ground Clearance', value: '2.9', units: 'ft' },
    { name: 'Maximum Digging Depth', value: '31.9', units: 'ft' },
  ],
  [key('Caterpillar', 'Excavator', '374')]: [
    { name: 'Engine Model', value: 'Cat C15' },
    { name: 'Net Power (ISO 9249)', value: '484', units: 'hp' },
    { name: 'Bore', value: '5.4', units: 'in' },
    { name: 'Stroke', value: '6.7', units: 'in' },
    { name: 'Displacement', value: '928', units: 'in^3' },
    { name: 'Max Pressure (Equipment)', value: '4500', units: 'psi' },
    { name: 'Max Pressure (Travel)', value: '4000', units: 'psi' },
    { name: 'Max Pressure (Swing)', value: '3800', units: 'psi' },
    { name: 'Main Hydraulic Flow (Implement)', value: '237', units: 'gal/min' },
    { name: 'Max Swing Torque', value: '200333', units: 'lbf-ft' },
    { name: 'Operating Weight', value: '162900', units: 'lb' },
    { name: 'Fuel Tank Capacity', value: '250', units: 'gal' },
    { name: 'Cooling System Capacity', value: '15', units: 'gal' },
    { name: 'Engine Oil Capacity', value: '14', units: 'gal' },
    { name: 'Swing Drive Capacity (each)', value: '3', units: 'gal' },
    { name: 'Final Drive Capacity (each)', value: '3', units: 'gal' },
    { name: 'Hydraulic System Capacity (incl. tank)', value: '175', units: 'gal' },
    { name: 'Hydraulic Tank Capacity', value: '70', units: 'gal' },
    { name: 'DEF Tank Capacity', value: '20', units: 'gal' },
    { name: 'Boom Length (GP)', value: '7.8', units: 'm' },
    { name: 'Stick Length (R)', value: '3.6', units: 'm' },
    { name: 'Max Reach at Ground Level', value: '43.2', units: 'ft' },
    { name: 'Maximum Cutting Height', value: '38', units: 'ft' },
    { name: 'Shipping/Transport Length', value: '35', units: 'ft' },
    { name: 'Tail Swing Radius', value: '13', units: 'ft' },
    { name: 'Track Gauge', value: '11.6', units: 'ft' },
    { name: 'Ground Clearance', value: '2.9', units: 'ft' },
    { name: 'Maximum Digging Depth', value: '28.1', units: 'ft' },
  ],
  [key('Caterpillar', 'Excavator', '336')]: [
    { name: 'Engine Model', value: 'Cat C9.3B' },
    { name: 'Net Power (ISO 9249)', value: '311', units: 'hp' },
    { name: 'Bore', value: '5', units: 'in' },
    { name: 'Stroke', value: '6', units: 'in' },
    { name: 'Displacement', value: '568', units: 'in^3' },
    { name: 'Max Pressure (Equipment)', value: '3700', units: 'psi' },
    { name: 'Max Pressure (Travel)', value: '3200', units: 'psi' },
    { name: 'Max Pressure (Swing)', value: '2800', units: 'psi' },
    { name: 'Main Hydraulic Flow (Implement)', value: '190', units: 'gal/min' },
    { name: 'Max Swing Torque', value: '150333', units: 'lbf-ft' },
    { name: 'Operating Weight', value: '81100', units: 'lb' },
    { name: 'Fuel Tank Capacity', value: '158.5', units: 'gal' },
    { name: 'Cooling System Capacity', value: '10.2', units: 'gal' },
    { name: 'Engine Oil Capacity', value: '6.6', units: 'gal' },
    { name: 'Swing Drive Capacity (each)', value: '4.8', units: 'gal' },
    { name: 'Final Drive Capacity (each)', value: '2', units: 'gal' },
    { name: 'Hydraulic System Capacity (incl. tank)', value: '98.5', units: 'gal' },
    { name: 'Hydraulic Tank Capacity', value: '42.5', units: 'gal' },
    { name: 'DEF Tank Capacity', value: '17', units: 'gal' },
    { name: 'Boom Length (GP)', value: '6.5', units: 'm' },
    { name: 'Stick Length (R)', value: '3.2', units: 'm' },
    { name: 'Max Reach at Ground Level', value: '38.7', units: 'ft' },
    { name: 'Maximum Cutting Height', value: '33', units: 'ft' },
    { name: 'Shipping/Transport Length', value: '29', units: 'ft' },
    { name: 'Tail Swing Radius', value: '11', units: 'ft' },
    { name: 'Track Gauge', value: '9.6', units: 'ft' },
    { name: 'Ground Clearance', value: '2.9', units: 'ft' },
    { name: 'Maximum Digging Depth', value: '20.1', units: 'ft' },
  ],
  [key('John Deere', 'Excavator', '870G')]: [
    { name: 'Engine Model', value: 'PowerTech 13.5L' },
    { name: 'Net Power (ISO 9249)', value: '512', units: 'hp' },
    { name: 'Bore', value: '5.2', units: 'in' },
    { name: 'Stroke', value: '6.3', units: 'in' },
    { name: 'Displacement', value: '824', units: 'in^3' },
    { name: 'Max Pressure (Equipment)', value: '5512', units: 'psi' },
    { name: 'Max Pressure (Travel)', value: '5076', units: 'psi' },
    { name: 'Max Pressure (Swing)', value: '4949', units: 'psi' },
    { name: 'Main Hydraulic Flow (Implement)', value: '237', units: 'gal/min' },
    { name: 'Max Swing Torque', value: '189400', units: 'lbf-ft' },
    { name: 'Operating Weight', value: '188716', units: 'lb' },
    { name: 'Fuel Tank Capacity', value: '344', units: 'gal' },
    { name: 'Cooling System Capacity', value: '16', units: 'gal' },
    { name: 'Engine Oil Capacity', value: '13', units: 'gal' },
    { name: 'Swing Drive Capacity (each)', value: '4.5', units: 'gal' },
    { name: 'Final Drive Capacity (each)', value: '13', units: 'gal' },
    { name: 'Hydraulic System Capacity (incl. tank)', value: '188', units: 'gal' },
    { name: 'Hydraulic Tank Capacity', value: '85', units: 'gal' },
    { name: 'DEF Tank Capacity', value: '12', units: 'gal' },
    { name: 'Boom Length (GP)', value: '8.1', units: 'm' },
    { name: 'Stick Length (R)', value: '4.0', units: 'm' },
    { name: 'Max Reach at Ground Level', value: '48.9', units: 'ft' },
    { name: 'Maximum Cutting Height', value: '44.2', units: 'ft' },
    { name: 'Shipping/Transport Length', value: '50.2', units: 'ft' },
    { name: 'Tail Swing Radius', value: '16.4', units: 'ft' },
    { name: 'Track Gauge', value: '11.5', units: 'ft' },
    { name: 'Ground Clearance', value: '2.1', units: 'ft' },
    { name: 'Maximum Digging Depth', value: '32.5', units: 'ft' },
  ],
  [key('Komatsu', 'Excavator', 'PC1250')]: [
    { name: 'Engine Model', value: 'Komatsu SDA12V159E-3' },
    { name: 'Net Power (ISO 9249)', value: '672', units: 'hp' },
    { name: 'Bore', value: '5.9', units: 'in' },
    { name: 'Stroke', value: '6.7', units: 'in' },
    { name: 'Displacement', value: '1837', units: 'in^3' },
    { name: 'Max Pressure (Equipment)', value: '5000', units: 'psi' },
    { name: 'Max Pressure (Travel)', value: '4470', units: 'psi' },
    { name: 'Max Pressure (Swing)', value: '4410', units: 'psi' },
    { name: 'Main Hydraulic Flow (Implement)', value: '321', units: 'gal/min' },
    { name: 'Max Swing Torque', value: '224000', units: 'lbf-ft' },
    { name: 'Operating Weight', value: '253000', units: 'lb' },
    { name: 'Fuel Tank Capacity', value: '475', units: 'gal' },
    { name: 'Cooling System Capacity', value: '38', units: 'gal' },
    { name: 'Engine Oil Capacity', value: '21', units: 'gal' },
    { name: 'Swing Drive Capacity (each)', value: '5.3', units: 'gal' },
    { name: 'Final Drive Capacity (each)', value: '11', units: 'gal' },
    { name: 'Hydraulic System Capacity (incl. tank)', value: '330', units: 'gal' },
    { name: 'Hydraulic Tank Capacity', value: '180', units: 'gal' },
    { name: 'DEF Tank Capacity', value: '18', units: 'gal' },
    { name: 'Boom Length (GP)', value: '8.3', units: 'm' },
    { name: 'Stick Length (R)', value: '3.6', units: 'm' },
    { name: 'Max Reach at Ground Level', value: '46.6', units: 'ft' },
    { name: 'Maximum Cutting Height', value: '41.3', units: 'ft' },
    { name: 'Shipping/Transport Length', value: '49.9', units: 'ft' },
    { name: 'Tail Swing Radius', value: '17.2', units: 'ft' },
    { name: 'Track Gauge', value: '13.1', units: 'ft' },
    { name: 'Ground Clearance', value: '3.0', units: 'ft' },
    { name: 'Maximum Digging Depth', value: '30.2', units: 'ft' },
  ],
  [key('Volvo', 'Excavator', 'EC750E')]: [
    { name: 'Engine Model', value: 'Volvo D16J' },
    { name: 'Net Power (ISO 9249)', value: '515', units: 'hp' },
    { name: 'Bore', value: '5.7', units: 'in' },
    { name: 'Stroke', value: '6.5', units: 'in' },
    { name: 'Displacement', value: '982', units: 'in^3' },
    { name: 'Max Pressure (Equipment)', value: '5076', units: 'psi' },
    { name: 'Max Pressure (Travel)', value: '4949', units: 'psi' },
    { name: 'Max Pressure (Swing)', value: '4560', units: 'psi' },
    { name: 'Main Hydraulic Flow (Implement)', value: '246', units: 'gal/min' },
    { name: 'Max Swing Torque', value: '210000', units: 'lbf-ft' },
    { name: 'Operating Weight', value: '158500', units: 'lb' },
    { name: 'Fuel Tank Capacity', value: '238', units: 'gal' },
    { name: 'Cooling System Capacity', value: '15', units: 'gal' },
    { name: 'Engine Oil Capacity', value: '11', units: 'gal' },
    { name: 'Swing Drive Capacity (each)', value: '3.7', units: 'gal' },
    { name: 'Final Drive Capacity (each)', value: '4.2', units: 'gal' },
    { name: 'Hydraulic System Capacity (incl. tank)', value: '188', units: 'gal' },
    { name: 'Hydraulic Tank Capacity', value: '82', units: 'gal' },
    { name: 'DEF Tank Capacity', value: '16', units: 'gal' },
    { name: 'Boom Length (GP)', value: '7.55', units: 'm' },
    { name: 'Stick Length (R)', value: '3.5', units: 'm' },
    { name: 'Max Reach at Ground Level', value: '42.8', units: 'ft' },
    { name: 'Maximum Cutting Height', value: '39.7', units: 'ft' },
    { name: 'Shipping/Transport Length', value: '39.4', units: 'ft' },
    { name: 'Tail Swing Radius', value: '12.8', units: 'ft' },
    { name: 'Track Gauge', value: '11.5', units: 'ft' },
    { name: 'Ground Clearance', value: '2.3', units: 'ft' },
    { name: 'Maximum Digging Depth', value: '27.9', units: 'ft' },
  ],
  [key('Caterpillar', 'Bulldozer', 'D11')]: [
    { name: 'Engine Model', value: 'Cat C32 ACERT' },
    { name: 'Gross Power', value: '850', units: 'hp' },
    { name: 'Operating Weight', value: '248500', units: 'lb' },
    { name: 'Blade Capacity', value: '43.6', units: 'yd³' },
    { name: 'Blade Width', value: '21.0', units: 'ft' },
    { name: 'Ground Pressure', value: '15.9', units: 'psi' },
    { name: 'Drawbar Pull', value: '170000', units: 'lbf' },
    { name: 'Fuel Tank Capacity', value: '425', units: 'gal' },
    { name: 'Transmission', value: 'Planetary powershift 3F/3R' },
    { name: 'Cooling System Capacity', value: '87', units: 'gal' },
    { name: 'Hydraulic System Capacity', value: '96', units: 'gal' },
    { name: 'Implement Pump Flow', value: '153', units: 'gal/min' },
    { name: 'Ripper Lift Height', value: '4.0', units: 'ft' },
    { name: 'Max Travel Speed (Fwd)', value: '7.3', units: 'mph' },
    { name: 'Max Travel Speed (Rev)', value: '9.3', units: 'mph' },
  ],
  [key('ThermoSense', 'Sensor', 'CTS-500')]: [
    { name: 'Measurement Range', value: '-20 to 120', units: '°C' },
    { name: 'Accuracy', value: '±0.2', units: '°C' },
    { name: 'Sampling Interval', value: '60', units: 's' },
    { name: 'Communication', value: 'LoRaWAN / LTE dual-path' },
    { name: 'Battery Autonomy', value: '45', units: 'days' },
    { name: 'Ingress Protection', value: 'IP68' },
    { name: 'Calibration', value: 'Factory multi-point & on-site check' },
    { name: 'Mounting', value: 'Re-usable stainless pod with anchor points' },
    { name: 'Gateway Capacity', value: '48', units: 'nodes' },
  ],
}

export function getFallbackManifestation(vendor: string, machine: string, model: string): AtomManifestationResponse | null {
  const lookup = FALLBACK_DATA[key(vendor, machine, model)]
  if (!lookup) return null

  return {
    vendor,
    machineType: machine,
    model,
    attributes: lookup.map((row, index) => ({
      id: `${vendor}-${machine}-${model}-${index}`,
      vendor,
      machineType: machine,
      model,
      name: row.name,
      value: row.value,
      units: row.units ?? null,
      validation: null,
    })),
    count: lookup.length,
    asOf: new Date().toISOString(),
  }
}
