import type { ProjectControlCenterPayload } from "../api";

type Payload = ProjectControlCenterPayload;

const clonePayload = (payload: Payload): Payload =>
  JSON.parse(JSON.stringify(payload)) as Payload;

const diamerBasha: Payload = {
  project: {
    id: "diamer-basha",
    name: "Diamer Basha Dam",
    phase: "Construction",
    status_pct: 20,
    alerts: 12,
    lat: 35.619,
    lng: 74.616,
    status_label: null,
    image: "/images/ACCS/diamer.jpg",
    address: "Diamer Basha Dam, Gilgit-Baltistan, Pakistan",
    geofence_radius_m: 2000,
  },
  contracts: [
    {
      id: "mw-01-main-dam",
      project_id: "diamer-basha",
      name: "MW-01 – Main Dam",
      phase: "Phase-1 (Dam Part)",
      discipline: "Civil",
      lat: 35.623,
      lng: 74.6135,
      status_pct: 74,
      status_label: "Construction",
      alerts: 5,
      image: "/images/contracts/blueprint.jpg",
    },
    {
      id: "mw-02-rb-powerhouse",
      project_id: "diamer-basha",
      name: "MW-02 – RB Powerhouse",
      phase: "Phase-1 (Dam Part)",
      discipline: "Mechanical",
      lat: 35.6248,
      lng: 74.6236,
      status_pct: 62,
      status_label: "Construction",
      alerts: 3,
      image: "/images/contracts/blueprint.jpg",
    },
    {
      id: "mw-02-lb-powerhouse",
      project_id: "diamer-basha",
      name: "MW-02 – LB Powerhouse",
      phase: "Phase-1 (Dam Part)",
      discipline: "Mechanical",
      lat: 35.6229,
      lng: 74.6202,
      status_pct: 54,
      status_label: "Bidding",
      alerts: 3,
      image: "/images/contracts/blueprint.jpg",
    },
    {
      id: "em-01-lb",
      project_id: "diamer-basha",
      name: "EM-01 – LB",
      phase: "Phase-1 (Dam Part)",
      discipline: "Electrical",
      lat: 35.6215,
      lng: 74.6207,
      status_pct: 58,
      status_label: "Bidding",
      alerts: 2,
      image: "/images/contracts/blueprint.jpg",
    },
    {
      id: "em-01-rb",
      project_id: "diamer-basha",
      name: "EM-01 – RB",
      phase: "Phase-1 (Dam Part)",
      discipline: "Electrical",
      lat: 35.6239,
      lng: 74.6244,
      status_pct: 52,
      status_label: "Bidding",
      alerts: 2,
      image: "/images/contracts/blueprint.jpg",
    },
    {
      id: "em-02-lb",
      project_id: "diamer-basha",
      name: "EM-02 – LB",
      phase: "Phase-1 (Dam Part)",
      discipline: "Electrical",
      lat: 35.6226,
      lng: 74.6185,
      status_pct: 48,
      status_label: "Pre-PQ",
      alerts: 3,
      image: "/images/contracts/blueprint.jpg",
    },
    {
      id: "em-02-rb",
      project_id: "diamer-basha",
      name: "EM-02 – RB",
      phase: "Phase-1 (Dam Part)",
      discipline: "Electrical",
      lat: 35.6234,
      lng: 74.6279,
      status_pct: 45,
      status_label: "Pre-PQ",
      alerts: 4,
      image: "/images/contracts/blueprint.jpg",
    },
    {
      id: "hm-01",
      project_id: "diamer-basha",
      name: "HM-1",
      phase: "Phase-2 (Power Generation)",
      discipline: "Hydro-Mechanical",
      lat: 35.6258,
      lng: 74.6138,
      status_pct: 20,
      status_label: "Bidding",
      alerts: 1,
      image: "/images/contracts/blueprint.jpg",
    },
    {
      id: "hm-02",
      project_id: "diamer-basha",
      name: "HM-2 – LB",
      phase: "Phase-2 (Power Generation)",
      discipline: "Hydro-Mechanical",
      lat: 35.6268,
      lng: 74.6109,
      status_pct: 12,
      status_label: "Pre-PQ",
      alerts: 2,
      image: "/images/contracts/blueprint.jpg",
    },
    {
      id: "hm-02-rb",
      project_id: "diamer-basha",
      name: "HM-2 – RB",
      phase: "Phase-2 (Power Generation)",
      discipline: "Hydro-Mechanical",
      lat: 35.6273,
      lng: 74.6146,
      status_pct: 10,
      status_label: "PQ",
      alerts: 2,
      image: "/images/contracts/blueprint.jpg",
    },
  ],
  metrics: {
    physical: { actual: 68.8, planned: 71.1 },
    workOutputs: [
      { label: "Design Output", status: "Ahead", percent: 37.9 },
      { label: "Preparatory Output", status: "On Track", percent: 34.5 },
      { label: "Construction Output", status: "Behind", percent: 68.2 },
    ],
    milestones: [
      { label: "Diversion Completed", status: "Achieved" },
      { label: "RCC Lift 42", status: "In Progress" },
      { label: "Powerhouse Fit-out", status: "Planned" },
    ],
    quality: [
      { label: "NCRs", closed: 22, open: 17, target: "≤ 12 open" },
      { label: "QA/QC Observations", closed: 12, open: 10, target: "≤ 8 open" },
      { label: "Quality Confidence", closed: 88, open: 12, target: "≥ 90%" },
    ],
    workInProgress: [
      { contract: "MW-01 – Main Dam", status: "Construction", percent: 74 },
      {
        contract: "MW-02 – RB Powerhouse",
        status: "Construction",
        percent: 62,
      },
      { contract: "MW-02 – LB Powerhouse", status: "Bidding", percent: 54 },
      { contract: "EM-01 – LB", status: "Bidding", percent: 58 },
      { contract: "EM-01 – RB", status: "Bidding", percent: 52 },
      { contract: "EM-02 – LB", status: "Pre-PQ", percent: 48 },
      { contract: "EM-02 – RB", status: "Pre-PQ", percent: 45 },
      { contract: "HM-1", status: "Bidding", percent: 20 },
      { contract: "HM-2 – LB", status: "Pre-PQ", percent: 12 },
      { contract: "HM-2 – RB", status: "PQ", percent: 10 },
    ],
    spi: {
      value: 0.98,
      status: "Monitoring",
      runway_days: 28,
      burn_rate_days: 32,
      cash_flow: 85,
    },
  },
  sow_tree: [
    {
      contract_id: "mw-01-main-dam",
      contract_name: "MW-01 – Main Dam",
      sections: [
        {
          id: "sow-mw01-prelim",
          title: "Preliminary and General Item",
          status: "In Progress",
          progress: 71.5,
          clauses: [
            {
              id: "clause-mw01-prelim-1",
              title: "Site mobilisation",
              status: "At Risk",
              lead: "Logistics",
              start_date: "2024-01-05",
              due_date: "2024-02-20",
              progress: 54.2,
              sequence: 1,
            },
            {
              id: "clause-mw01-prelim-2",
              title: "Temporary works setup",
              status: "Monitoring",
              lead: "Civils",
              start_date: "2024-02-21",
              due_date: "2024-03-30",
              progress: 88.8,
              sequence: 2,
            },
          ],
        },
        {
          id: "sow-mw01-river",
          title: "River diversion & care of water",
          status: "On Track",
          progress: 90.3,
          clauses: [
            {
              id: "clause-mw01-river-1",
              title: "Cofferdam installation",
              status: "On Track",
              lead: "Hydraulics",
              start_date: "2024-04-01",
              due_date: "2024-07-30",
              progress: 90.3,
              sequence: 1,
            },
            {
              id: "clause-mw01-river-2",
              title: "Diversion channel excavation",
              status: "On Track",
              lead: "Excavation",
              start_date: "2024-05-10",
              due_date: "2024-09-12",
              progress: 90.3,
              sequence: 2,
            },
          ],
        },
        {
          id: "sow-mw01-rcc",
          title: "RCC Dam",
          status: "Monitoring",
          progress: 86.8,
          clauses: [
            {
              id: "clause-mw01-rcc-1",
              title: "Left bank RCC placements",
              status: "Monitoring",
              lead: "Civil Works",
              start_date: "2024-06-01",
              due_date: "2024-11-15",
              progress: 86.8,
              sequence: 1,
            },
            {
              id: "clause-mw01-rcc-2",
              title: "Instrumentation embeds",
              status: "Monitoring",
              lead: "Instrumentation",
              start_date: "2024-08-01",
              due_date: "2024-12-20",
              progress: 86.8,
              sequence: 2,
            },
          ],
        },
      ],
    },
    {
      contract_id: "mw-02-rb-powerhouse",
      contract_name: "MW-02 – RB Powerhouse",
      sections: [
        {
          id: "sow-mw02-turbine",
          title: "Turbine hall excavation",
          status: "In Progress",
          progress: 55,
          clauses: [
            {
              id: "clause-mw02-turbine-1",
              title: "Rock support works",
              status: "In Progress",
              lead: "Geotech",
              start_date: "2024-05-05",
              due_date: "2024-09-01",
              progress: 52,
              sequence: 1,
            },
          ],
        },
        {
          id: "sow-mw02-fitout",
          title: "Powerhouse fit-out",
          status: "In Progress",
          progress: 47,
          clauses: [],
        },
      ],
    },
  ],
};

const mohmandDam: Payload = {
  project: {
    id: "mohmand-dam",
    name: "Mohmand Dam",
    phase: "Construction",
    status_pct: 43,
    alerts: 28,
    lat: 34.755,
    lng: 71.215,
    status_label: null,
    image: "/images/ACCS/mohmand.jpg",
    address: "Mohmand Dam, Mohmand Agency, Pakistan",
    geofence_radius_m: 1500,
  },
  contracts: diamerBasha.contracts.map((contract) => ({
    ...contract,
    project_id: "mohmand-dam",
  })),
  metrics: diamerBasha.metrics,
  sow_tree: diamerBasha.sow_tree,
};

const dasuHpp: Payload = {
  project: {
    id: "dasu-hpp",
    name: "Dasu Hydropower Project",
    phase: "Construction",
    status_pct: 20,
    alerts: 22,
    lat: 35.291,
    lng: 72.103,
    status_label: null,
    image: "/images/ACCS/ghazi.png",
    address: "Dasu Hydropower Project, Upper Kohistan, Pakistan",
    geofence_radius_m: 1800,
  },
  contracts: diamerBasha.contracts.map((contract) => ({
    ...contract,
    project_id: "dasu-hpp",
  })),
  metrics: diamerBasha.metrics,
  sow_tree: diamerBasha.sow_tree,
};

const manglaDam: Payload = {
  project: {
    id: "mangla",
    name: "Mangla Dam",
    phase: "O&M",
    status_pct: 100,
    alerts: 22,
    status_label: "Maintenance",
    lat: 33.135,
    lng: 73.64,
    image: "/images/AOS/mangla.jpg",
    address: "Mangla Dam, Mirpur, Azad Kashmir",
    geofence_radius_m: 1600,
  },
  contracts: diamerBasha.contracts.map((contract) => ({
    ...contract,
    project_id: "mangla",
    phase: contract.phase.replace("Phase-1 (Dam Part)", "Operations"),
    status_label: "In-operation",
  })),
  metrics: diamerBasha.metrics,
  sow_tree: diamerBasha.sow_tree,
};

const fallbackMap: Record<string, Payload> = {
  [diamerBasha.project.id]: diamerBasha,
  [mohmandDam.project.id]: mohmandDam,
  [dasuHpp.project.id]: dasuHpp,
  [manglaDam.project.id]: manglaDam,
};

export function getProjectControlCenterFallback(
  projectId: string
): Payload | null {
  const payload = fallbackMap[projectId];
  return payload ? clonePayload(payload) : null;
}
